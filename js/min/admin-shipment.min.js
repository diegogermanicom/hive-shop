/**
 * @author Diego Martín
 * @copyright Hive®
 * @version 1.0
 * @lastUpdated 2025
 */
var ADMIN_SHIPMENT={init:function(){this.newEvents(),this.editEvents(),this.newZoneEvents(),this.editZoneEvents()},getZoneCountries:function(n,e=1){var i=this,s={id_shipping_zone:parseInt($("#input-id-shipping-zone").val()),id_continent:n,page:e};$.ajax({url:ADMIN_PATH+"/get-shipping-zone-countries",data:s,success:function(e){"ok"==e.get_shipping_zone_countries.response&&($("#shipping-zone-countries").html(e.get_shipping_zone_countries.html),$("#shipping-zone-countries-pager").html(e.get_shipping_zone_countries.pager),$("#shipping-zone-countries-pager .btn").off().on("click",(function(){let e=$(this).data("page");i.getZoneCountries(n,e)})),i.checkAllInput("#shipping-zone-countries"),$('#shipping-zone-countries input[type="checkbox"]').off().on("click",(function(){i.checkAllInput("#shipping-zone-countries")})))}})},getZoneProvinces:function(n,e=1){var i=this,s={id_shipping_zone:parseInt($("#input-id-shipping-zone").val()),id_country:n,page:e};$.ajax({url:ADMIN_PATH+"/get-shipping-zone-provinces",data:s,success:function(e){"ok"==e.get_shipping_zone_provinces.response&&($("#shipping-zone-provinces").html(e.get_shipping_zone_provinces.html),$("#shipping-zone-provinces-pager").html(e.get_shipping_zone_provinces.pager),$("#shipping-zone-provinces-pager .btn").off().on("click",(function(){let e=$(this).data("page");i.getZoneProvinces(n,e)})),i.checkAllInput("#shipping-zone-provinces"),$('#shipping-zone-provinces input[type="checkbox"]').off().on("click",(function(){i.checkAllInput("#shipping-zone-provinces")})))}})},checkAllInput:function(n){var e=$(n).closest("div[id-tab]"),i=!0;$(n+' input[type="checkbox"]').each((function(){$(this).is(":checked")||(i=!1)})),e.find(".btn-select-all").prop("checked",i)},newEvents:function(){1==$("body#admin-new-shipping-method-page").length&&$("#btn-save-new-shipment").on("click",(function(){var n=$(this),e={alias:$("#input-alias").val().trim(),min_value:parseInt($("#input-min-value").val()),max_value:parseInt($("#input-max-value").val()),min_weight:parseInt($("#input-min-weight").val()),max_weight:parseInt($("#input-max-weight").val()),id_state:parseInt($("#select-state").val()),languages:[]};$("#languages .menu > div").each((function(){let n=$(this).attr("id-tab"),i=$(this).closest("#languages").find('.content > div[id-tab="'+n+'"]'),s={id_lang:parseInt($(this).attr("id-lang")),name:$(i).find(".input-language-name").val().trim()};e.languages.push(s)}));var i=UTILS.validateForm("#form-new-shipment");n.hasClass("disabled")||1!=i.response||(n.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-shipment",data:e,success:function(e){"ok"==e.save_new_shipment.response?(n.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/shipments?new"):(s,UTILS.showInfo("Error",e.save_new_shipment.message),n.removeClass("disabled"))}}))}))},editEvents:function(){1==$("body#admin-edit-shipping-method-page").length&&($("#btn-delete-shipment").on("click",(function(){var n=$(this),e={id_shipping_method:parseInt($("#input-id-shipping-method").val())};n.hasClass("disabled")||(n.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-shipment",data:e,success:function(n){"ok"==n.delete_shipment.response&&(window.location.href=ADMIN_PATH+"/shipments?delete")}}))})),$("#btn-save-edit-shipment").on("click",(function(){var n=$(this),e={id_shipping_method:parseInt($("#input-id-shipping-method").val()),alias:$("#input-alias").val().trim(),min_value:parseInt($("#input-min-value").val()),max_value:parseInt($("#input-max-value").val()),min_weight:parseInt($("#input-min-weight").val()),max_weight:parseInt($("#input-max-weight").val()),id_state:parseInt($("#select-state").val()),languages:[],zones:[]};$("#languages .menu > div").each((function(){let n=$(this).attr("id-tab"),i=$(this).closest("#languages").find('.content > div[id-tab="'+n+'"]'),s={id_lang:parseInt($(this).attr("id-lang")),name:$(i).find(".input-language-name").val().trim()};e.languages.push(s)})),$("#shipping-method-zones .shipping-zone").each((function(){let n=$(this).find('input[type="checkbox"]').prop("checked")?1:0;var i={id_shipping_zone:$(this).data("id-shipping-zone"),active:n,prices:[]};$(this).find('input[type="text"]').each((function(){let n={id_shipping_method_weight:$(this).data("id-shipping-method-weight"),price:$(this).val().trim()};i.prices.push(n)})),e.zones.push(i)}));var i=UTILS.validateForm("#form-edit-shipment");n.hasClass("disabled")||1!=i.response||(n.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-shipment",data:e,success:function(e){"ok"==e.save_edit_shipment.response?UTILS.showInfo("Correct!",e.save_edit_shipment.message):UTILS.showInfo("Error",e.save_edit_shipment.message),n.removeClass("disabled")}}))})))},newZoneEvents:function(){1==$("body#admin-new-shipping-zone-page").length&&$("#btn-save-new-shipping-zone").on("click",(function(){var n=$(this),e={name:$("#input-name").val().trim(),id_state:parseInt($("#select-state").val())},i=UTILS.validateForm("#form-new-shipping-zone");n.hasClass("disabled")||1!=i.response||(n.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-shipping-zone",data:e,success:function(e){"ok"==e.save_new_shipping_zone.response?(n.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/shipping-zones?new"):(UTILS.showInfo("Error",e.save_new_shipping_zone.message),n.removeClass("disabled"))}}))}))},editZoneEvents:function(){if(1==$("body#admin-edit-shipping-zone-page").length){var n=this;this.getZoneCountries(0),this.getZoneProvinces(0),this.checkAllInput("#shipping-zone-continents"),$('#shipping-zone-continents input[type="checkbox"]').on("click",(function(){n.checkAllInput("#shipping-zone-continents")})),$("#btn-select-all-continents").on("click",(function(){var n=$(this).prop("checked");$("#shipping-zone-continents input").each((function(){$(this).prop("checked",n)}))})),$("#btn-select-all-countries").on("click",(function(){var n=$(this).prop("checked");$("#shipping-zone-countries input").each((function(){$(this).prop("checked",n)}))})),$("#btn-select-all-provinces").on("click",(function(){var n=$(this).prop("checked");$("#shipping-zone-provinces input").each((function(){$(this).prop("checked",n)}))})),$("#select-countries-continents").on("change",(function(){let e=parseInt($(this).val());n.getZoneCountries(e)})),$("#select-provinces-countries").on("change",(function(){let e=parseInt($(this).val());n.getZoneProvinces(e)})),$("#btn-delete-shipping-zone").on("click",(function(){var n=$(this),e={id_shipping_zone:parseInt($("#input-id-shipping-zone").val())};n.hasClass("disabled")||(n.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-shipping-zone",data:e,success:function(n){"ok"==n.delete_shipping_zone.response&&(window.location.href=ADMIN_PATH+"/shipping-zones?delete")}}))})),$("#btn-save-edit-shipping-zone").on("click",(function(){var n=$(this),e={id_shipping_zone:parseInt($("#input-id-shipping-zone").val()),name:$("#input-name").val().trim(),id_state:parseInt($("#select-state").val()),continents:[],continents_add:[],countries:[],countries_add:[],provinces:[],provinces_add:[]};$("#shipping-zone-continents input").each((function(){let n=parseInt($(this).val());0!=n&&(e.continents.push(n),$(this).prop("checked")&&e.continents_add.push(n))})),$("#shipping-zone-countries input").each((function(){let n=parseInt($(this).val());0!=n&&(e.countries.push(n),$(this).prop("checked")&&e.countries_add.push(n))})),$("#shipping-zone-provinces input").each((function(){let n=parseInt($(this).val());0!=n&&(e.provinces.push(n),$(this).prop("checked")&&e.provinces_add.push(n))}));var i=UTILS.validateForm("#form-edit-shipping-zone");n.hasClass("disabled")||1!=i.response||(n.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-shipping-zone",data:e,success:function(e){"ok"==e.save_edit_shipping_zone.response?UTILS.showInfo("Correct!",e.save_edit_shipping_zone.message):UTILS.showInfo("Error",e.save_edit_shipping_zone.message),n.removeClass("disabled")}}))}))}}};$(window).ready((function(){ADMIN_SHIPMENT.init()}));