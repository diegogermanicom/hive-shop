/**
 * @author Diego Martín
 * @copyright Hive®
 * @version 1.0
 * @lastUpdated 2025
 */
var ADMIN_PAYMENT={init:function(){this.newEvents(),this.editEvents(),this.newZoneEvents(),this.editZoneEvents()},getZoneCountries:function(e,n=1){var t=this,a={id_payment_zone:parseInt($("#input-id-payment-zone").val()),id_continent:e,page:n};$.ajax({url:ADMIN_PATH+"/get-payment-zone-countries",data:a,success:function(n){"ok"==n.get_payment_zone_countries.response&&($("#payment-zone-countries").html(n.get_payment_zone_countries.html),$("#payment-zone-countries-pager").html(n.get_payment_zone_countries.pager),$("#payment-zone-countries-pager .btn").off().on("click",(function(){let n=$(this).data("page");t.getZoneCountries(e,n)})),t.checkAllInput("#payment-zone-countries"),$('#payment-zone-countries input[type="checkbox"]').off().on("click",(function(){t.checkAllInput("#payment-zone-countries")})))}})},getZoneProvinces:function(e,n=1){var t=this,a={id_payment_zone:parseInt($("#input-id-payment-zone").val()),id_country:e,page:n};$.ajax({url:ADMIN_PATH+"/get-payment-zone-provinces",data:a,success:function(n){"ok"==n.get_payment_zone_provinces.response&&($("#payment-zone-provinces").html(n.get_payment_zone_provinces.html),$("#payment-zone-provinces-pager").html(n.get_payment_zone_provinces.pager),$("#payment-zone-provinces-pager .btn").off().on("click",(function(){let n=$(this).data("page");t.getZoneProvinces(e,n)})),t.checkAllInput("#payment-zone-provinces"),$('#payment-zone-provinces input[type="checkbox"]').off().on("click",(function(){t.checkAllInput("#payment-zone-provinces")})))}})},checkAllInput:function(e){var n=$(e).closest("div[id-tab]"),t=!0;$(e+' input[type="checkbox"]').each((function(){$(this).is(":checked")||(t=!1)})),n.find(".btn-select-all").prop("checked",t)},newEvents:function(){1==$("body#admin-new-payment-method-page").length&&$("#btn-save-new-payment").on("click",(function(){var e=$(this),n={alias:$("#input-alias").val().trim(),min_value:parseInt($("#input-min-value").val()),max_value:parseInt($("#input-max-value").val()),id_state:parseInt($("#select-state").val()),languages:[]};$("#languages .menu > div").each((function(){let e=$(this).attr("id-tab"),t=$(this).closest("#languages").find('.content > div[id-tab="'+e+'"]'),a={id_lang:parseInt($(this).attr("id-lang")),name:$(t).find(".input-language-name").val().trim()};n.languages.push(a)}));var t=UTILS.validateForm("#form-new-payment");e.hasClass("disabled")||1!=t.response||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-payment",data:n,success:function(n){"ok"==n.save_new_payment.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/payments?new"):(UTILS.showInfo("Error",n.save_new_payment.message),e.removeClass("disabled"))}}))}))},editEvents:function(){1==$("body#admin-edit-payment-method-page").length&&($("#btn-delete-payment").on("click",(function(){var e=$(this),n={id_payment_method:parseInt($("#input-id-payment-method").val())};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-payment",data:n,success:function(e){"ok"==e.delete_payment.response&&(window.location.href=ADMIN_PATH+"/payments?delete")}}))})),$("#btn-save-edit-payment").on("click",(function(){var e=$(this),n={id_payment_method:parseInt($("#input-id-payment-method").val()),alias:$("#input-alias").val().trim(),min_value:parseInt($("#input-min-value").val()),max_value:parseInt($("#input-max-value").val()),id_state:parseInt($("#select-state").val()),languages:[],zones:[]};$("#languages .menu > div").each((function(){let e=$(this).attr("id-tab"),t=$(this).closest("#languages").find('.content > div[id-tab="'+e+'"]'),a={id_lang:parseInt($(this).attr("id-lang")),name:$(t).find(".input-language-name").val().trim()};n.languages.push(a)})),$("#payment-method-zones .payment-zone").each((function(){let e=$(this).find('input[type="checkbox"]').prop("checked")?1:0;var t={id_payment_zone:$(this).data("id-payment-zone"),active:e};n.zones.push(t)}));var t=UTILS.validateForm("#form-edit-payment");e.hasClass("disabled")||1!=t.response||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-payment",data:n,success:function(n){"ok"==n.save_edit_payment.response?UTILS.showInfo("Correct!",n.save_edit_payment.message):UTILS.showInfo("Error",n.save_edit_payment.message),e.removeClass("disabled")}}))})))},newZoneEvents:function(){1==$("body#admin-new-payment-zone-page").length&&$("#btn-save-new-payment-zone").on("click",(function(){var e=$(this),n={name:$("#input-name").val().trim(),id_state:parseInt($("#select-state").val())},t=UTILS.validateForm("#form-new-payment-zone");e.hasClass("disabled")||1!=t.response||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-payment-zone",data:n,success:function(n){"ok"==n.save_new_payment_zone.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/payment-zones?new"):(UTILS.showInfo("Error",n.save_new_payment_zone.message),e.removeClass("disabled"))}}))}))},editZoneEvents:function(){if(1==$("body#admin-edit-payment-zone-page").length){var e=this;this.getZoneCountries(0),this.getZoneProvinces(0),this.checkAllInput("#payment-zone-continents"),$('#payment-zone-continents input[type="checkbox"]').on("click",(function(){e.checkAllInput("#payment-zone-continents")})),$("#btn-select-all-continents").on("click",(function(){var e=$(this).prop("checked");$("#payment-zone-continents input").each((function(){$(this).prop("checked",e)}))})),$("#btn-select-all-countries").on("click",(function(){var e=$(this).prop("checked");$("#payment-zone-countries input").each((function(){$(this).prop("checked",e)}))})),$("#btn-select-all-provinces").on("click",(function(){var e=$(this).prop("checked");$("#payment-zone-provinces input").each((function(){$(this).prop("checked",e)}))})),$("#select-countries-continents").on("change",(function(){let n=parseInt($(this).val());e.getZoneCountries(n)})),$("#select-provinces-countries").on("change",(function(){let n=parseInt($(this).val());e.getZoneProvinces(n)})),$("#btn-delete-payment-zone").on("click",(function(){var e=$(this),n={id_payment_zone:parseInt($("#input-id-payment-zone").val())};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-payment-zone",data:n,success:function(e){"ok"==e.delete_payment_zone.response&&(window.location.href=ADMIN_PATH+"/payment-zones?delete")}}))})),$("#btn-save-edit-payment-zone").on("click",(function(){var e=$(this),n={id_payment_zone:parseInt($("#input-id-payment-zone").val()),name:$("#input-name").val().trim(),id_state:parseInt($("#select-state").val()),continents:[],continents_add:[],countries:[],countries_add:[],provinces:[],provinces_add:[]};$("#payment-zone-continents input").each((function(){let e=parseInt($(this).val());0!=e&&(n.continents.push(e),$(this).prop("checked")&&n.continents_add.push(e))})),$("#payment-zone-countries input").each((function(){let e=parseInt($(this).val());0!=e&&(n.countries.push(e),$(this).prop("checked")&&n.countries_add.push(e))})),$("#payment-zone-provinces input").each((function(){let e=parseInt($(this).val());0!=e&&(n.provinces.push(e),$(this).prop("checked")&&n.provinces_add.push(e))}));var t=UTILS.validateForm("#form-edit-payment-zone");e.hasClass("disabled")||1!=t.response||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-payment-zone",data:n,success:function(n){"ok"==n.save_edit_payment_zone.response?UTILS.showInfo("Correct!",n.save_edit_payment_zone.message):UTILS.showInfo("Error",n.save_edit_payment_zone.message),e.removeClass("disabled")}}))}))}}};$(window).ready((function(){ADMIN_PAYMENT.init()}));