/**
 * @author Diego Martín
 * @copyright Hive®
 * @version 1.0
 * @lastUpdated 2025
 */
var ADMIN={init:function(){this.menuLeftEvents(),this.sendLoginEvent(),this.sitemapEvent(),this.categoriesEvent(),this.categoriesCustomRoutesEvents(),this.newCategoryEvent(),this.editCategoryEvent(),this.attributesEvent(),this.newAttributeEvent(),this.editAttributeEvents(),this.imagesEvent(),this.codesEvent(),this.newCodeEvent(),this.editCodeEvent(),this.usersEvent(),this.editUserEvents(),this.adminUsersEvent(),this.newAdminUserEvent(),this.editAdminUserEvents(),this.cartEvents()},newEditAttributeEvents:function(){$("#attribute-values-list").sortable({group:"list",animation:200,ghostClass:"ghost"}),$("#select-type").on("change",(function(){let e=$("#select-type").val();$("#input-value-alias").val(""),$("#input-property-color").val(""),$("#upload-image").attr("image-name",""),$("#upload-image").css("background-image",""),$(".content-new-value *").removeClass("error"),$("#value-property-color").addClass("hidden"),$("#value-property-image").addClass("hidden"),2==e?$("#value-property-color").removeClass("hidden"):3==e&&$("#value-property-image").removeClass("hidden"),$("#attribute-values-list").html("")})),$("#input-value-property-image").on("change",(function(){var e=this.files[0];let t=["image/jpg","image/jpeg","image/png"];if(this.files){if(t.includes(e.type)){let t=new FileReader;t.onload=function(t){t.total<=1e6?($("#upload-image").attr("image-name",e.name),$("#upload-image").css("background-image","url("+t.target.result+")")):UTILS.showInfo("Error","Image size cannot be larger than 1 mb.")},t.readAsDataURL(e)}this.value=""}})),$("#btn-add-attribute-value").on("click",(function(){let e=$("#select-type").val(),t={alias:$("#input-value-alias").val().trim(),property:""};if(2==e?t.property=$("#input-value-property-color").val().trim():3==e&&(t.property={data:$("#upload-image").css("background-image"),name:$("#upload-image").attr("image-name")},t.property.data=t.property.data.substring(5),t.property.data=t.property.data.substring(0,t.property.data.length-2)),$(".content-new-value *").removeClass("error"),""==t.alias&&$("#input-value-alias").addClass("error"),2!=e||UTILS.validate("hexadecimal",t.property)?3==e&&""==t.property.name&&$("#upload-image").addClass("error"):$("#input-value-property-color").addClass("error"),0==$(".content-new-value .error").length){let a="";a+='<div class="list-item" value="'+t.alias+'" id-attribute-value="0">'+t.alias,2==e?a+=' <div class="value-color" value="'+t.property+'" style="background-color: '+t.property+';">'+t.property+"</div>":3==e&&(a+='<div class="new-value-list-image" style="background-image: url('+t.property.data+')" title="'+t.property.name+'"></div>'),a+='<div class="btn-delete-value"><i class="fa-solid fa-trash-can"></i></div>',a+='<div class="btn-edit-value disabled"><i class="fa-solid fa-pencil"></i></div>',a+="</div>",$("#input-value-alias").val(""),$("#input-value-property-color").val(""),$("#upload-image").attr("image-name",""),$("#upload-image").css("background-image",""),$("#attribute-values-list").append(a),$(".btn-delete-value").off().on("click",(function(){$(this).closest(".list-item").remove()}))}}))},getAttributeValues:function(e){var t={id_attribute:e,type:$("#select-type").val()};$.ajax({url:ADMIN_PATH+"/get-attribute-values",data:t,success:function(e){"ok"==e.get_attribute_values.response&&($("#attribute-values-list").html(""),$("#attribute-values-list").html(e.get_attribute_values.html),$(".btn-delete-value").off().on("click",(function(){$(this).closest(".list-item").remove()})),$(".btn-edit-value").on("click",(function(){var e=$(this).closest(".list-item").attr("id-attribute-value"),t={id_attribute_value:e};$.ajax({url:ADMIN_PATH+"/get-attribute-value-properties",data:t,success:function(t){"ok"==t.get_attribute_value_properties.response?($("#popup-attribute-value-properties").attr("id-attribute-value",e),$("#input-edit-value-alias").val(t.get_attribute_value_properties.alias),$("#value-properties-content").html(t.get_attribute_value_properties.html),UTILS.customTabEvent(),UTILS.showPopup("#popup-attribute-value-properties")):UTILS.showInfo("Error",t.get_attribute_value_properties.message)}})})))}})},getUserAddresses:function(e){var t={id_user:e};$.ajax({url:ADMIN_PATH+"/get-user-addresses",data:t,success:function(e){"ok"==e.get_user_addresses.response&&($("#content-addresses").html(e.get_user_addresses.html),$(".btn-edit-user-address").on("click",(function(){var e=$(this),t={id_user_address:parseInt(e.attr("id-user-address"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/get-user-address",data:t,success:function(t){if("ok"==t.get_user_address.response){let e=t.get_user_address.address;$("#btn-save-edit-address").attr("id-user-address",e.id_user_address),$("#input-edit-address-continent").val(e.id_continent),$("#input-edit-address-country").html(t.get_user_address.countries_html),$("#input-edit-address-province").html(t.get_user_address.provinces_html),$("#input-edit-address-address").val(e.address),$("#input-edit-address-location").val(e.location),$("#input-edit-address-postal-code").val(e.postal_code),$("#input-edit-address-telephone").val(e.telephone),UTILS.showPopup("#popup-edit-address")}e.removeClass("disabled")}}))})),$("#input-edit-address-continent").on("change",(function(){var e={id_continent:parseInt($(this).val())};$("#input-edit-address-country").html(""),$.ajax({url:ADMIN_PATH+"/get-countries-list",data:e,success:function(e){"ok"==e.get_countries_list.response&&$("#input-edit-address-country").html(e.get_countries_list.html)}})})),$("#input-edit-address-country").on("change",(function(){var e={id_country:parseInt($(this).val())};$("#input-edit-address-province").html(""),$.ajax({url:ADMIN_PATH+"/get-provinces-list",data:e,success:function(e){"ok"==e.get_provinces_list.response&&$("#input-edit-address-province").html(e.get_provinces_list.html)}})})),$(".btn-delete-user-address").on("click",(function(){var e=$(this),t={id_user_address:parseInt(e.attr("id-user-address"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-user-address",data:t,success:function(t){"ok"==t.delete_user_address.response?e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))})))}})},objSaveEditCategory:function(){var e={id_category:null,alias:$("#input-alias").val().trim(),id_parent:parseInt($("#select-id-parent").val()),id_view:parseInt($("#select-view").val()),id_state:parseInt($("#select-state").val()),properties:[],meta_data:[]};return $("#properties .menu > div").each((function(){let t=$(this).attr("id-tab"),a=$(this).closest("#properties").find('.content > div[id-tab="'+t+'"]'),s={id_lang:parseInt($(this).attr("id-lang")),name:$(a).find(".input-language-name").val().trim(),slug:$(a).find(".input-language-slug").val().trim(),description:$(a).find(".textarea-language-description").val().trim()};e.properties.push(s)})),$("#meta_data .menu > div").each((function(){let t=$(this).attr("id-tab"),a=$(this).closest("#meta_data").find('.content > div[id-tab="'+t+'"]'),s={id_lang:parseInt($(this).attr("id-lang")),meta_title:$(a).find(".input-language-meta-title").val().trim(),meta_keywords:$(a).find(".input-language-meta-keywords").val().trim(),meta_description:$(a).find(".textarea-language-meta-description").val().trim()};e.meta_data.push(s)})),e},objSaveEditAttribute:function(){var e={id_attribute:null,alias:$("#input-alias").val().trim(),type:parseInt($("#select-type").val()),view:parseInt($("#select-view").val()),properties:[],values:[]};$("#properties .menu > div").each((function(){let t=$(this).attr("id-tab"),a=$(this).closest("#properties").find('.content > div[id-tab="'+t+'"]'),s={id_lang:parseInt($(this).attr("id-lang")),name:$(a).find(".input-language-name").val().trim(),description:$(a).find(".textarea-language-description").val().trim()};e.properties.push(s)}));var t=1;return $("#attribute-values-list > div.list-item").each((function(){let a={id_attribute_value:parseInt($(this).attr("id-attribute-value")),alias:$(this).attr("value"),value:"",image_name:"",priority:t};2==e.type?a.value=$(this).find(".value-color").attr("value"):3==e.type&&(a.value=$(this).find(".new-value-list-image").css("background-image"),a.value=a.value.substring(5),a.value=a.value.substring(0,a.value.length-2),a.image_name=$(this).find(".new-value-list-image").attr("title")),e.values.push(a),t++})),e},objSaveValidCode:function(){var e={id_code:null,name:$("#input-name").val().trim(),code:$("#input-code").val().trim(),available:$("#input-available").val().trim(),per_user:$("#input-per-user").val().trim(),id_state:parseInt($("#select-state").val()),type:parseInt($("#select-type").val()),amount:$("#input-amount").val().trim(),registered:parseInt($("#select-registered").val()),exclude:parseInt($("#select-exclude").val()),minimum:$("#input-minimum").val().trim(),start_date:$("#input-start-date").val().trim(),end_date:$("#input-end-date").val().trim(),compatible:parseInt($("#select-compatible").val()),free_shipping:parseInt($("#select-free-shipping").val())};return $(".content-save-code *").removeClass("error"),UTILS.validate("min-char-3",e.name)||$("#input-name").addClass("error"),UTILS.validate("code",e.code)||$("#input-code").addClass("error"),UTILS.validate("number",e.available)?e.available=parseInt(e.available):$("#input-available").addClass("error"),UTILS.validate("number",e.per_user)?e.per_user=parseInt(e.per_user):$("#input-per-user").addClass("error"),UTILS.validate("price",e.amount)||$("#input-amount").addClass("error"),UTILS.validate("price",e.minimum)||$("#input-minimum").addClass("error"),UTILS.validate("date",e.start_date)||$("#input-start-date").addClass("error"),UTILS.validate("date",e.end_date)||$("#input-end-date").addClass("error"),e},menuLeftEvents:function(){$("#btn-hide-menu-left").on("click",(function(){$(this).removeClass("active"),$("#btn-show-menu-left").addClass("active"),$("#menu-left").removeClass("active"),$("#container-admin").addClass("expand")})),$("#btn-show-menu-left").on("click",(function(){$(this).removeClass("active"),$("#btn-hide-menu-left").addClass("active"),$("#menu-left").addClass("active"),$("#container-admin").removeClass("expand")}))},sendLoginEvent:function(){0!=$("body#admin-login-page").length&&$("#btn-send-login").on("click",(function(){var e=$(this),t={email:$("#input-email").val().trim(),pass:$("#input-pass").val().trim(),remember:null==$("#checkbox-admin-remember:checked").val()?0:1};$(".login-content *").removeClass("error"),""==t.email&&$("#input-email").addClass("error"),""==t.pass&&$("#input-pass").addClass("error"),e.hasClass("disabled")||0!=$(".login-content .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/send-login",data:t,success:function(t){"ok"==t.login.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/home?login"):(UTILS.showInfo("Uups",t.login.message),e.removeClass("disabled"))}}))}))},sitemapEvent:function(){0!=$("body#admin-sitemap").length&&$("#btn-create-sitemap").off().on("click",(function(){var e=$(this);e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/create-new-sitemap",data:{},success:function(t){"ok"==t.sitemap.response?(e.addClass("btn-ok"),UTILS.showInfo(t.sitemap.title,t.sitemap.message)):(e.removeClass("disabled"),UTILS.showInfo("Uups",t.sitemap.message))}}))}))},categoriesEvent:function(){1==$("body#admin-categories-page").length&&$(".btn-delete-category").on("click",(function(){var e=$(this),t={id_category:parseInt(e.attr("id-category"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-category",data:t,success:function(t){"ok"==t.delete_category.response?1==$("#categories-content tbody > tr").length?$("#categories-content").html("No categories"):e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},categoriesCustomRoutesEvents:function(){1==$("body#admin-categories-custom-routes-page").length&&($("#open-popup-new-category-custom-route").on("click",(function(){$("#categories-list").val(0),$("#languages-content input").val(""),$("#languages-content").addClass("hidden"),UTILS.showPopup("#popup-new-category-custom-route")})),$("#categories-list").on("change",(function(){$("#languages-content").removeClass("hidden")})),$("#btn-save-new-category-custom-route").on("click",(function(){var e=$(this),t={id_category:parseInt($("#categories-list").val()),routes:[]};$("#popup-new-category-custom-route *").removeClass("error"),$("#languages-content .item").each((function(){let e={id_language:parseInt($(this).attr("id-language")),route:$(this).find("input").val().trim()};UTILS.validate("slug",e.route)&&""!=e.route||$(this).find("input").addClass("error"),t.routes.push(e)})),0==t.id_category&&$("#categories-list").addClass("error"),e.hasClass("disabled")||0!=$("#popup-new-category-custom-route .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-category-custom-route",data:t,success:function(t){"ok"==t.save_new_category_custom_route.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/categories-custom-routes?new"):e.removeClass("disabled")}}))})),$(".btn-delete-category-custom-route").on("click",(function(){var e=$(this),t={id_category_custom_route:parseInt(e.attr("id-category-custom-route"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-category-custom-route",data:t,success:function(t){"ok"==t.delete_category_custom_route.response?1==$("#categories-custom-routes-content tbody > tr").length?$("#categories-custom-routes-content").html("No categories custom routes"):e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))})))},newCategoryEvent:function(){1==$("body#admin-new-category-page").length&&$("#btn-save-new-category").on("click",(function(){var e=$(this),t=ADMIN.objSaveEditCategory();$(".content-new-category *").removeClass("error"),UTILS.validate("min-char-3",t.alias)||$("#input-alias").addClass("error"),e.hasClass("disabled")||0!=$(".content-new-category .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-category",data:t,success:function(t){"ok"==t.save_new_category.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/categories?new"):(UTILS.showInfo("Error",t.save_new_category.message),e.removeClass("disabled"))}}))}))},editCategoryEvent:function(){1==$("body#admin-edit-category-page").length&&$("#btn-save-category").on("click",(function(){var e=$(this),t=ADMIN.objSaveEditCategory();t.id_category=parseInt($("#input-id-category").val()),$(".content-edit-category *").removeClass("error"),UTILS.validate("min-char-3",t.alias)||$("#input-alias").addClass("error"),e.hasClass("disabled")||0!=$(".content-edit-category .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-category",data:t,success:function(t){"ok"==t.save_edit_category.response?UTILS.showInfo("Correct!",t.save_edit_category.message):UTILS.showInfo("Error",t.save_edit_category.message),e.removeClass("disabled")}}))}))},attributesEvent:function(){1==$("body#admin-attributes-page").length&&$(".btn-delete-attribute").off().on("click",(function(){var e=$(this),t={id_attribute:parseInt(e.attr("id-attribute"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-attribute",data:t,success:function(t){"ok"==t.delete_attribute.response?1==$("#attributes-content tbody > tr").length?$("#attribute").html("No attributes"):e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},newAttributeEvent:function(){1==$("body#admin-new-attribute-page").length&&(ADMIN.newEditAttributeEvents(),$("#btn-save-new-attribute").on("click",(function(){var e=$(this),t=ADMIN.objSaveEditAttribute();$(".content-new-attribute *").removeClass("error"),UTILS.validate("min-char-3",t.alias)||$("#input-alias").addClass("error"),e.hasClass("disabled")||0!=$(".content-new-attribute .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-attribute",data:t,success:function(t){"ok"==t.save_new_attribute.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/attributes?new"):e.removeClass("disabled")}}))})))},editAttributeEvents:function(){if(1==$("body#admin-edit-attribute-page").length){let e=parseInt($("#input-id-attribute").val());ADMIN.getAttributeValues(e),ADMIN.newEditAttributeEvents(),$("#select-type").trigger("change"),$("#btn-save-attribute").on("click",(function(){var e=$(this),t=ADMIN.objSaveEditAttribute();t.id_attribute=parseInt($("#input-id-attribute").val()),$(".content-edit-attribute *").removeClass("error"),UTILS.validate("min-char-3",t.alias)||$("#input-alias").addClass("error"),e.hasClass("disabled")||0!=$(".content-edit-attribute .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-attribute",data:t,success:function(a){"ok"==a.save_edit_attribute.response&&(ADMIN.getAttributeValues(t.id_attribute),UTILS.showInfo("Correct!",a.save_edit_attribute.message)),e.removeClass("disabled")}}))})),$("#btn-save-edit-attribute-value").on("click",(function(){var e=$(this),t={id_attribute_value:parseInt($("#popup-attribute-value-properties").attr("id-attribute-value")),alias:$("#input-edit-value-alias").val().trim(),properties:[]};$("#value-properties-content .menu > div").each((function(){let e=$(this).attr("id-tab"),a=$(this).closest("#value-properties-content").find('.content > div[id-tab="'+e+'"]'),s={id_lang:parseInt($(this).attr("id-lang")),name:$(a).find(".input-value-name").val().trim(),description:$(a).find(".textarea-value-description").val().trim()};t.properties.push(s)})),e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-attribute-value-properties",data:t,success:function(t){if("ok"==t.save_attribute_value_properties.response){let e=parseInt($("#input-id-attribute").val());ADMIN.getAttributeValues(e),UTILS.closePopup("#popup-attribute-value-properties"),UTILS.showInfo("Correct!",t.save_attribute_value_properties.message)}e.removeClass("disabled")}}))}))}},imagesEvent:function(){1==$("body#admin-images-page").length&&$(".btn-delete-image").on("click",(function(){var e=$(this),t={id_image:parseInt($(this).attr("id-image"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-server-image",data:t,success:function(t){"ok"==t.delete_product_server_image.response?e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},codesEvent:function(){1==$("body#admin-codes-page").length&&$(".btn-delete-code").on("click",(function(){var e=$(this),t={id_code:parseInt(e.attr("id-code"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-code",data:t,success:function(t){"ok"==t.delete_code.response?e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},newCodeEvent:function(){if(1==$("body#admin-new-code-page").length){let e=new Date,t=e.getFullYear(),a=e.getMonth()+1;a<10&&(a="0"+a);let s=e.getDate();s<10&&(s="0"+s),$("#input-start-date").val(t+"-"+a+"-"+s),$("#input-end-date").val(t+1+"-"+a+"-"+s),$("#btn-save-new-code").on("click",(function(){var e=$(this),t=ADMIN.objSaveValidCode();e.hasClass("disabled")||0!=$(".content-save-code .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-code",data:t,success:function(t){"ok"==t.save_new_code.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/codes?new"):(UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled"))}}))}))}},editCodeRuleEvents:function(){$(".btn-delete-code-rule").off().on("click",(function(){var e=$(this),t={id_code_rule:parseInt(e.attr("id-code-rule"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-code-rule",data:t,success:function(t){"ok"==t.delete_code_rule.response?1==$("#code-rules tbody > tr").length?$("#code-rules").html("No code rules"):e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))})),$(".btn-edit-code-rule").off().on("click",(function(){var e=$(this),t={id_code_rule:parseInt(e.attr("id-code-rule"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/get-code-rule",data:t,success:function(t){"ok"==t.get_code_rule.response?($("#btn-save-code-rule").attr("id-code-rule",t.get_code_rule.rule.id_code_rule),$("#select-edit-code-rule-type").val(t.get_code_rule.rule.id_code_rule_type),$("#select-edit-code-rule-add-type").val(t.get_code_rule.rule.id_code_rule_add_type),$("#edit-code-rule-elements-list").html(t.get_code_rule.html_elements),$("#edit-code-rule-elements-added").html(t.get_code_rule.html_selected),ADMIN.editCodeRuleElementsEvent(),UTILS.showPopup("#popup-edit-code-rule")):UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},editCodeEvent:function(){if(1==$("body#admin-edit-code-page").length){let e=parseInt($("#input-id-code").val());ADMIN.getCodeRules(e),$("#btn-save-edit-code").on("click",(function(){var t=$(this),a=ADMIN.objSaveValidCode();a.id_code=e,t.hasClass("disabled")||0!=$(".content-save-code .error").length||(t.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-code",data:a,success:function(e){"ok"==e.save_edit_code.response&&UTILS.showInfo("Correct!",e.save_edit_code.message),t.removeClass("disabled")}}))})),$("#btn-open-popup-new-code-rule").on("click",(function(){$("#select-add-code-rule-type").val(1),$("#select-add-code-rule-add-type").val(1),$("#add-code-rule-elements-list").html(""),$("#add-code-rule-elements-added").html(""),$("#select-add-code-rule-type").trigger("change"),UTILS.showPopup("#popup-add-code-rule")})),$("#select-add-code-rule-type").on("change",(function(){var e=$(this),t={id_code_rule_type:parseInt(e.val())};e.prop("disabled",!0),$("#add-code-rule-elements-list").html(""),$("#add-code-rule-elements-added").html(""),$.ajax({url:ADMIN_PATH+"/get-code-rule-elements-list",data:t,async:!1,success:function(t){"ok"==t.get_code_rule_elements_list.response?($("#add-code-rule-elements-list").html(t.get_code_rule_elements_list.html),$("#add-code-rule-elements-list .list-item").off().on("click",(function(){let e=$(this).attr("value");if($(this).hasClass("active"))$(this).removeClass("active"),$('#add-code-rule-elements-added .list-item[value="'+e+'"]').remove();else{let t='<div class="list-item no-hover" value="'+e+'">'+$(this).html()+"</div>";$("#add-code-rule-elements-added").append(t),$(this).addClass("active")}}))):UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.prop("disabled",!1)}})})),$("#btn-add-code-rule").on("click",(function(){var t=$(this),a={id_code:e,id_rule_type:parseInt($("#select-add-code-rule-type").val()),id_rule_add_type:parseInt($("#select-add-code-rule-add-type").val()),elements:[]};$("#add-code-rule-elements-added .list-item").each((function(){let e=$(this).attr("value");a.elements.push(e)})),$("#popup-add-code-rule *").removeClass("error"),0==a.elements.length&&$("#add-code-rule-elements-added").addClass("error"),t.hasClass("disabled")||0!=$("#popup-add-code-rule .error").length||(t.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/add-code-rule",data:a,success:function(e){"ok"==e.add_code_rule.response?(0!=$("#code-rules table").length?$("#code-rules tbody").append(e.add_code_rule.html):$("#code-rules").html(e.add_code_rule.html),ADMIN.editCodeRuleEvents(),UTILS.closePopup("#popup-add-code-rule")):UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),t.removeClass("disabled")}}))})),$("#select-edit-code-rule-type").on("change",(function(){var e=$(this),t={id_code_rule_type:parseInt(e.val())};e.prop("disabled",!0),$("#edit-code-rule-elements-list").html(""),$("#edit-code-rule-elements-added").html(""),$.ajax({url:ADMIN_PATH+"/get-code-rule-elements-list",data:t,async:!1,success:function(t){"ok"==t.get_code_rule_elements_list.response?($("#edit-code-rule-elements-list").html(t.get_code_rule_elements_list.html),ADMIN.editCodeRuleElementsEvent()):UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.prop("disabled",!1)}})})),$("#btn-save-code-rule").on("click",(function(){var t=$(this),a={id_code_rule:t.attr("id-code-rule"),id_rule_type:parseInt($("#select-edit-code-rule-type").val()),id_rule_add_type:parseInt($("#select-edit-code-rule-add-type").val()),elements:[]};$("#edit-code-rule-elements-added .list-item").each((function(){let e=$(this).attr("value");a.elements.push(e)})),$("#popup-edit-code-rule *").removeClass("error"),0==a.elements.length&&$("#edit-code-rule-elements-added").addClass("error"),t.hasClass("disabled")||0!=$("#popup-edit-code-rule .error").length||(t.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-code-rule",data:a,success:function(a){"ok"==a.save_code_rule.response?(ADMIN.getCodeRules(e),UTILS.showInfo("Correct!",a.save_code_rule.message)):UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),t.removeClass("disabled")}}))}))}},getCodeRules:function(e){var t={id_code:e};$.ajax({url:ADMIN_PATH+"/get-code-rules",data:t,success:function(e){"ok"==e.get_code_rules.response&&($("#code-rules").html(e.get_code_rules.html),ADMIN.editCodeRuleEvents())}})},editCodeRuleElementsEvent:function(){$("#edit-code-rule-elements-list .list-item").off().on("click",(function(){let e=$(this).attr("value");if($(this).hasClass("active"))$(this).removeClass("active"),$('#edit-code-rule-elements-added .list-item[value="'+e+'"]').remove();else{let t='<div class="list-item no-hover" value="'+e+'">'+$(this).html()+"</div>";$("#edit-code-rule-elements-added").append(t),$(this).addClass("active")}}))},usersEvent:function(){1==$("body#admin-users-page").length&&$(".btn-delete-user").on("click",(function(){var e=$(this),t={id_user:parseInt(e.attr("id-user"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-user",data:t,success:function(t){"ok"==t.delete_user.response?e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},editUserEvents:function(){1==$("body#admin-edit-user-page").length&&(ADMIN.getUserAddresses($("#input-id-user").val().trim()),$("#btn-save-edit-address").on("click",(function(){var e=$(this),t={id_user_address:parseInt(e.attr("id-user-address")),id_continent:parseInt($("#input-edit-address-continent").val()),id_country:parseInt($("#input-edit-address-country").val()),id_province:parseInt($("#input-edit-address-province").val()),address:$("#input-edit-address-address").val().trim(),location:$("#input-edit-address-location").val().trim(),postal_code:$("#input-edit-address-postal-code").val().trim(),telephone:$("#input-edit-address-telephone").val().trim()};$(".content-edit-address *").removeClass("error"),""==t.address&&$("#input-edit-address-address").addClass("error"),""==t.location&&$("#input-edit-address-location").addClass("error"),UTILS.validate("cp",t.postal_code)||$("#input-edit-address-postal-code").addClass("error"),UTILS.validate("telephone",t.telephone)||$("#input-edit-address-telephone").addClass("error"),e.hasClass("disabled")||0!=$(".content-edit-address .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-user-address",data:t,success:function(t){"ok"==t.save_edit_user_address.response&&UTILS.showInfo("Correct!",t.save_edit_user_address.message),e.removeClass("disabled")}}))})),$("#btn-close-user-sessions").on("click",(function(){var e=$(this),t={id_user:parseInt($("#input-id-user").val().trim())};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/close-user-sessions",data:t,success:function(t){"ok"==t.close_user_seassons.response&&UTILS.showInfo("Correct!",t.close_user_seassons.message),e.removeClass("disabled")}}))})),$("#btn-resend-validation-email").on("click",(function(){var e=$(this),t={id_user:parseInt($("#input-id-user").val().trim())};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/send-validation-email",data:t,success:function(t){if("ok"==t.send_validation_email.response){let e='<div class="pb-10">'+t.send_validation_email.message+"</div>";e+="<div><b>Link:</b> "+t.send_validation_email.link+"</div>",UTILS.showInfo("Correct!",e)}e.removeClass("disabled")}}))})),$("#btn-save-edit-user").on("click",(function(){var e=$(this),t={id_user:parseInt($("#input-id-user").val().trim()),name:$("#input-name").val().trim(),lastname:$("#input-last-name").val().trim(),email:$("#input-email").val().trim(),id_state:parseInt($("#select-state").val())};null!=$('input[name="input-address-main"]:checked').val()&&(t.id_address_main=parseInt($('input[name="input-address-main"]:checked').val())),$(".content-edit-user *").removeClass("error"),UTILS.validate("name",t.name)||$("#input-name").addClass("error"),UTILS.validate("lastname",t.lastname)||$("#input-last-name").addClass("error"),UTILS.validate("email",t.email)||$("#input-email").addClass("error"),e.hasClass("disabled")||0!=$(".content-edit-user .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-user",data:t,success:function(t){"ok"==t.save_edit_user.response&&UTILS.showInfo("Correct!",t.save_edit_user.message),e.removeClass("disabled")}}))})))},adminUsersEvent:function(){1==$("body#admin-users-admin-page").length&&$(".btn-delete-admin").on("click",(function(){var e=$(this),t={id_admin:parseInt(e.attr("id-admin"))};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/delete-admin-user",data:t,success:function(t){"ok"==t.delete_admin_user.response?e.closest("tr").remove():UTILS.showInfo("Uups","An unexpected error has occurred.<br>Reload the page to try again."),e.removeClass("disabled")}}))}))},newAdminUserEvent:function(){1==$("body#admin-new-admin-user-page").length&&$("#btn-save-new-admin-user").on("click",(function(){var e=$(this),t={name:$("#input-name").val().trim(),lastname:$("#input-last-name").val().trim(),email:$("#input-email").val().trim(),pass1:$("#input-password-1").val().trim(),pass2:$("#input-password-2").val().trim(),id_admin_type:parseInt($("#select-admin-type").val())};$(".content-new-admin-user *").removeClass("error"),UTILS.validate("name",t.name)||$("#input-name").addClass("error"),UTILS.validate("lastname",t.lastname)||$("#input-last-name").addClass("error"),UTILS.validate("email",t.email)||$("#input-email").addClass("error"),(""==t.pass1||t.pass1.length<8)&&$("#input-password-1").addClass("error"),(""==t.pass2||t.pass2.length<8)&&$("#input-password-2").addClass("error"),t.pass1!=t.pass2&&$("#input-password-2").addClass("error"),e.hasClass("disabled")||0!=$(".content-new-admin-user .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-new-admin-user",data:t,success:function(t){"ok"==t.save_new_admin_user.response?(e.addClass("btn-ok"),window.location.href=ADMIN_PATH+"/users-admin?new"):(UTILS.showInfo("Error",t.save_new_admin_user.message),e.removeClass("disabled"))}}))}))},editAdminUserEvents:function(){1==$("body#admin-edit-user-admin-page").length&&(setTimeout((function(){$("#input-password-1").val("")}),1e3),$("#btn-close-admin-user-sessions").on("click",(function(){var e=$(this),t={id_admin:parseInt($("#input-id-admin").val())};e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/close-admin-user-sessions",data:t,success:function(t){"ok"==t.close_admin_user_sessions.response&&UTILS.showInfo("Correct!",t.close_admin_user_sessions.message),e.removeClass("disabled")}}))})),$("#btn-save-edit-admin-user").on("click",(function(){var e=$(this),t={id_admin:parseInt($("#input-id-admin").val()),name:$("#input-name").val().trim(),lastname:$("#input-last-name").val().trim(),email:$("#input-email").val().trim(),pass1:$("#input-password-1").val().trim(),pass2:$("#input-password-2").val().trim(),id_admin_type:parseInt($("#select-admin-type").val()),id_state:parseInt($("#select-state").val())};$(".content-edit-admin-user *").removeClass("error"),UTILS.validate("name",t.name)||$("#input-name").addClass("error"),UTILS.validate("lastname",t.lastname)||$("#input-last-name").addClass("error"),UTILS.validate("email",t.email)||$("#input-email").addClass("error"),""==t.pass1&&""==t.pass2||(t.pass1.length<8&&$("#input-password-1").addClass("error"),t.pass2.length<8&&$("#input-password-2").addClass("error"),t.pass1!=t.pass2&&$("#input-password-2").addClass("error")),e.hasClass("disabled")||0!=$(".content-edit-admin-user .error").length||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/save-edit-admin-user",data:t,success:function(t){"ok"==t.save_edit_admin_user.response&&UTILS.showInfo("Correct!",t.save_edit_admin_user.message),e.removeClass("disabled")}}))})))},cartEvents:function(){$("#btn-create-order-from-cart").on("click",(function(){var e=$(this);e.hasClass("disabled")||(e.addClass("disabled"),$.ajax({url:ADMIN_PATH+"/create-order-from-cart",data:{id_cart:1},success:function(t){"ok"==t.create_order_from_cart.response&&e.addClass("btn-ok")}}))}))}};$(window).ready((function(){ADMIN.init()}));